(define (derivative f)
  (let ((epsilon (gensym)))
    (lambda (x)
      (tangent epsilon (f (make-bundle epsilon x 1))))))

(define (gradient-f f)
  (lambda (x)
    (let ((n (length x)))
      (map-n (lambda (i)
               ((derivative (lambda (displacement)
                              (f (v+ x (ex displacement i n)))))
                0))
             n))))

